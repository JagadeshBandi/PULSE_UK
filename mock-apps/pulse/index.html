<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pulse - UK Payday Friday Traffic Simulator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .app-container {
            max-width: 414px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            box-shadow: 0 0 40px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }
        
        .app-header {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }
        
        .app-header h1 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .pulse-icon {
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #3498db, #2980b9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 16px;
            color: white;
        }
        
        .app-header p {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .status-bar {
            background: #34495e;
            color: white;
            padding: 8px 20px;
            font-size: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .traffic-indicator {
            background: #e74c3c;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .balance-card {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            margin: 20px;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .balance-amount {
            font-size: 32px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .balance-label {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .traffic-stats {
            background: #f8f9fa;
            margin: 20px;
            padding: 20px;
            border-radius: 15px;
            border: 1px solid #e9ecef;
        }
        
        .stats-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        .stat-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .stat-label {
            color: #495057;
        }
        
        .stat-value {
            font-weight: 600;
            color: #2c3e50;
        }
        
        .actions-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            padding: 20px;
        }
        
        .action-button {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }
        
        .action-button:active {
            transform: translateY(0);
        }
        
        .action-button.danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }
        
        .action-button.success {
            background: linear-gradient(135deg, #27ae60, #229954);
        }
        
        .action-button.warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }
        
        .traffic-log {
            background: #2c3e50;
            color: white;
            margin: 20px;
            padding: 15px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .log-entry {
            margin-bottom: 5px;
            opacity: 0.9;
        }
        
        .log-entry.success {
            color: #2ecc71;
        }
        
        .log-entry.error {
            color: #e74c3c;
        }
        
        .log-entry.warning {
            color: #f39c12;
        }
        
        .log-entry.info {
            color: #3498db;
        }
        
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .loading-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            max-width: 300px;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .hidden {
            display: none;
        }
        
        .metrics-panel {
            background: #ecf0f1;
            margin: 20px;
            padding: 20px;
            border-radius: 15px;
        }
        
        .metric-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 10px;
            background: white;
            border-radius: 8px;
        }
        
        .metric-name {
            font-size: 14px;
            color: #495057;
        }
        
        .metric-value {
            font-size: 14px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .metric-value.high {
            color: #e74c3c;
        }
        
        .metric-value.medium {
            color: #f39c12;
        }
        
        .metric-value.low {
            color: #27ae60;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="app-header">
            <h1>
                <div class="pulse-icon">P</div>
                Pulse
            </h1>
            <p>UK Payday Friday Traffic Simulator</p>
        </div>
        
        <div class="status-bar">
            <span id="current-time">9:41 AM</span>
            <span class="traffic-indicator">PAYDAY FRIDAY</span>
            <span>üì∂ 4G</span>
            <span>üîã 87%</span>
        </div>
        
        <div id="app-content">
            <div class="balance-card">
                <div class="balance-label">Current Balance</div>
                <div class="balance-amount" id="balance">¬£5,250.00</div>
                <div class="balance-label" id="balance-updated">Last Updated: Just Now</div>
            </div>
            
            <div class="traffic-stats">
                <div class="stats-title">üìä Live Traffic Statistics</div>
                <div class="stat-row">
                    <span class="stat-label">Concurrent Users:</span>
                    <span class="stat-value" id="concurrent-users">0</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Active Payments:</span>
                    <span class="stat-value" id="active-payments">0</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Success Rate:</span>
                    <span class="stat-value" id="success-rate">100%</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Avg Response Time:</span>
                    <span class="stat-value" id="avg-response-time">0ms</span>
                </div>
            </div>
            
            <div class="metrics-panel">
                <div class="stats-title">üìà Performance Metrics</div>
                <div class="metric-item">
                    <span class="metric-name">Payment Processing</span>
                    <span class="metric-value" id="payment-metric">Ready</span>
                </div>
                <div class="metric-item">
                    <span class="metric-name">Balance Check</span>
                    <span class="metric-value" id="balance-metric">Ready</span>
                </div>
                <div class="metric-item">
                    <span class="metric-name">API Response</span>
                    <span class="metric-value" id="api-metric">Ready</span>
                </div>
                <div class="metric-item">
                    <span class="metric-name">Network Status</span>
                    <span class="metric-value" id="network-metric">4G</span>
                </div>
            </div>
            
            <div class="actions-grid">
                <button class="action-button" onclick="startPaydaySimulation()">
                    üöÄ Start Payday Friday
                </button>
                <button class="action-button" onclick="makePayment()">
                    üí≥ Make Payment
                </button>
                <button class="action-button" onclick="checkBalance()">
                    üí∞ Check Balance
                </button>
                <button class="action-button" onclick="simulateHighTraffic()">
                    üìà High Traffic Mode
                </button>
                <button class="action-button danger" onclick="simulateNetworkFailure()">
                    üö´ Network Failure
                </button>
                <button class="action-button warning" onclick="simulatePoorConnection()">
                    üì∂ Poor Connection
                </button>
                <button class="action-button success" onclick="simulateOptimalPerformance()">
                    ‚ö° Optimal Performance
                </button>
                <button class="action-button" onclick="showAllTraffic()">
                    üåê Show All Traffic
                </button>
            </div>
            
            <div class="traffic-log" id="traffic-log">
                <div class="log-entry info">[PULSE] System initialized. Ready for Payday Friday simulation.</div>
                <div class="log-entry info">[PULSE] Waiting for user action...</div>
            </div>
        </div>
        
        <div class="loading-overlay" id="loading-overlay">
            <div class="loading-content">
                <div class="spinner"></div>
                <div id="loading-message">Processing...</div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let concurrentUsers = 0;
        let activePayments = 0;
        let totalPayments = 0;
        let successfulPayments = 0;
        let responseTimes = [];
        let isPaydayMode = false;
        let simulationInterval = null;
        let realTimeInterval = null;
        let backgroundActivityInterval = null;
        
        // Utility functions
        function log(message, type = 'info') {
            const logElement = document.getElementById('traffic-log');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry ${type}`;
            logEntry.textContent = `[${timestamp}] ${message}`;
            logElement.appendChild(logEntry);
            logElement.scrollTop = logElement.scrollHeight;
            
            // Keep log size manageable
            while (logElement.children.length > 50) {
                logElement.removeChild(logElement.firstChild);
            }
        }
        
        function showLoading(message) {
            document.getElementById('loading-message').textContent = message;
            document.getElementById('loading-overlay').style.display = 'flex';
        }
        
        function hideLoading() {
            document.getElementById('loading-overlay').style.display = 'none';
        }
        
        function updateMetrics() {
            document.getElementById('concurrent-users').textContent = concurrentUsers.toLocaleString();
            document.getElementById('active-payments').textContent = activePayments.toLocaleString();
            
            const successRate = totalPayments > 0 ? 
                Math.round((successfulPayments / totalPayments) * 100) : 100;
            document.getElementById('success-rate').textContent = successRate + '%';
            
            const avgResponseTime = responseTimes.length > 0 ? 
                Math.round(responseTimes.reduce((a, b) => a + b, 0) / responseTimes.length) : 0;
            document.getElementById('avg-response-time').textContent = avgResponseTime + 'ms';
        }
        
        function updateMetricStatus(metricId, status, level) {
            const element = document.getElementById(metricId);
            element.textContent = status;
            element.className = `metric-value ${level}`;
        }
        
        // Real-time clock update
        function updateClock() {
            const now = new Date();
            const hours = now.getHours();
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const ampm = hours >= 12 ? 'PM' : 'AM';
            const displayHours = hours % 12 || 12;
            document.getElementById('current-time').textContent = `${displayHours}:${minutes} ${ampm}`;
        }
        
        // Simulate realistic delays
        function simulateDelay(min, max) {
            return new Promise(resolve => {
                const delay = Math.random() * (max - min) + min;
                setTimeout(resolve, delay);
            });
        }
        
        // Generate random data variations
        function generateRandomVariation(baseValue, variance) {
            return baseValue + (Math.random() - 0.5) * variance;
        }
        
        // Background activity simulation
        function simulateBackgroundActivity() {
            // Random user activity
            if (Math.random() < 0.3) {
                concurrentUsers = Math.max(0, Math.floor(generateRandomVariation(concurrentUsers, 100)));
            }
            
            // Random payment activity
            if (Math.random() < 0.2 && activePayments > 0) {
                activePayments = Math.max(0, Math.floor(generateRandomVariation(activePayments, 50)));
            }
            
            // Random response time variations
            if (Math.random() < 0.1) {
                const randomResponseTime = Math.floor(generateRandomVariation(500, 300));
                responseTimes.push(randomResponseTime);
                if (responseTimes.length > 20) responseTimes.shift();
            }
            
            updateMetrics();
        }
        
        // Main functions
        async function startPaydaySimulation() {
            log('[PULSE] Starting Payday Friday simulation...', 'info');
            showLoading('Initializing Payday Friday mode...');
            
            isPaydayMode = true;
            concurrentUsers = 1000;
            
            // Start background simulation
            simulationInterval = setInterval(() => {
                if (isPaydayMode) {
                    concurrentUsers = Math.min(10000, Math.floor(generateRandomVariation(concurrentUsers, 500)));
                    activePayments = Math.floor(concurrentUsers * 0.3);
                    updateMetrics();
                    
                    // Random background payments
                    if (Math.random() < 0.7) {
                        simulateBackgroundPayment();
                    }
                }
            }, 2000);
            
            await simulateDelay(1000, 2000);
            hideLoading();
            log('[PULSE] Payday Friday simulation started!', 'success');
            updateMetricStatus('payment-metric', 'Peak Load', 'high');
        }
        
        async function makePayment() {
            const startTime = Date.now();
            log('[PULSE] Initiating payment...', 'info');
            showLoading('Processing payment...');
            
            try {
                // Simulate payment processing with realistic delays
                await simulateDelay(2000, 5000);
                
                // Simulate occasional failures during peak hours
                if (isPaydayMode && Math.random() < 0.05) {
                    throw new Error('Payment failed due to high traffic');
                }
                
                const responseTime = Date.now() - startTime;
                responseTimes.push(responseTime);
                totalPayments++;
                successfulPayments++;
                activePayments--;
                
                // Update balance with realistic variation
                const currentBalance = parseFloat(document.getElementById('balance').textContent.replace('¬£', '').replace(',', ''));
                const paymentAmount = Math.floor(generateRandomVariation(800, 400));
                const newBalance = currentBalance - paymentAmount;
                document.getElementById('balance').textContent = '¬£' + newBalance.toLocaleString('en-GB', {minimumFractionDigits: 2});
                
                // Update timestamp
                updateBalanceTimestamp();
                
                updateMetrics();
                hideLoading();
                log(`[PULSE] Payment of ¬£${paymentAmount} completed in ${responseTime}ms`, 'success');
                
                // Update metric status
                if (responseTime < 3000) {
                    updateMetricStatus('payment-metric', 'Excellent', 'low');
                } else if (responseTime < 5000) {
                    updateMetricStatus('payment-metric', 'Good', 'medium');
                } else {
                    updateMetricStatus('payment-metric', 'Slow', 'high');
                }
                
            } catch (error) {
                totalPayments++;
                activePayments--;
                updateMetrics();
                hideLoading();
                log(`[PULSE] Payment failed: ${error.message}`, 'error');
                updateMetricStatus('payment-metric', 'Failed', 'high');
            }
        }
        
        async function checkBalance() {
            const startTime = Date.now();
            log('[PULSE] Checking account balance...', 'info');
            showLoading('Retrieving balance...');
            
            try {
                await simulateDelay(800, 2000);
                
                const responseTime = Date.now() - startTime;
                responseTimes.push(responseTime);
                
                // Update balance with small variation
                const currentBalance = parseFloat(document.getElementById('balance').textContent.replace('¬£', '').replace(',', ''));
                const variation = generateRandomVariation(0, 50);
                const newBalance = currentBalance + variation;
                document.getElementById('balance').textContent = '¬£' + newBalance.toLocaleString('en-GB', {minimumFractionDigits: 2});
                
                updateBalanceTimestamp();
                
                hideLoading();
                log(`[PULSE] Balance retrieved in ${responseTime}ms`, 'success');
                
                // Update metric status
                if (responseTime < 1500) {
                    updateMetricStatus('balance-metric', 'Excellent', 'low');
                } else if (responseTime < 2500) {
                    updateMetricStatus('balance-metric', 'Good', 'medium');
                } else {
                    updateMetricStatus('balance-metric', 'Slow', 'high');
                }
                
            } catch (error) {
                hideLoading();
                log(`[PULSE] Balance check failed: ${error.message}`, 'error');
                updateMetricStatus('balance-metric', 'Failed', 'high');
            }
        }
        
        function updateBalanceTimestamp() {
            const now = new Date();
            document.getElementById('balance-updated').textContent = `Last Updated: ${now.toLocaleTimeString()}`;
        }
        
        async function simulateHighTraffic() {
            log('[PULSE] Simulating high traffic conditions...', 'warning');
            showLoading('Scaling up traffic...');
            
            concurrentUsers = 5000;
            activePayments = 2000;
            
            // Simulate multiple concurrent operations
            for (let i = 0; i < 5; i++) {
                setTimeout(() => simulateBackgroundPayment(), i * 500);
            }
            
            await simulateDelay(2000, 3000);
            updateMetrics();
            hideLoading();
            log('[PULSE] High traffic simulation active!', 'warning');
            updateMetricStatus('api-metric', 'High Load', 'high');
        }
        
        async function simulateNetworkFailure() {
            log('[PULSE] Simulating network failure...', 'error');
            showLoading('Network failure simulation...');
            
            // Simulate network outage
            await simulateDelay(3000, 5000);
            
            hideLoading();
            log('[PULSE] Network failure simulated - testing resilience', 'error');
            updateMetricStatus('network-metric', 'Down', 'high');
            updateMetricStatus('api-metric', 'Unavailable', 'high');
            updateMetricStatus('payment-metric', 'Unavailable', 'high');
            
            // Recovery after 5 seconds
            setTimeout(() => {
                log('[PULSE] Network restored', 'success');
                updateMetricStatus('network-metric', '4G', 'low');
                updateMetricStatus('api-metric', 'Recovered', 'medium');
                updateMetricStatus('payment-metric', 'Available', 'low');
            }, 5000);
        }
        
        async function simulatePoorConnection() {
            log('[PULSE] Simulating poor connection...', 'warning');
            showLoading('Adjusting network conditions...');
            
            updateMetricStatus('network-metric', '3G', 'medium');
            updateMetricStatus('api-metric', 'Slow', 'high');
            
            await simulateDelay(1000, 2000);
            hideLoading();
            log('[PULSE] Poor connection simulated', 'warning');
            
            // Simulate slow responses
            const originalSimulateDelay = window.simulateDelay;
            window.simulateDelay = (min, max) => {
                return originalSimulateDelay(min * 2, max * 2);
            };
            
            // Restore after 10 seconds
            setTimeout(() => {
                window.simulateDelay = originalSimulateDelay;
                log('[PULSE] Connection restored', 'success');
                updateMetricStatus('network-metric', '4G', 'low');
                updateMetricStatus('api-metric', 'Normal', 'low');
            }, 10000);
        }
        
        async function simulateOptimalPerformance() {
            log('[PULSE] Simulating optimal performance...', 'success');
            showLoading('Optimizing performance...');
            
            concurrentUsers = 100;
            activePayments = 10;
            
            updateMetricStatus('network-metric', '5G', 'low');
            updateMetricStatus('api-metric', 'Optimal', 'low');
            updateMetricStatus('payment-metric', 'Fast', 'low');
            updateMetricStatus('balance-metric', 'Instant', 'low');
            
            await simulateDelay(1000, 1500);
            updateMetrics();
            hideLoading();
            log('[PULSE] Optimal performance mode active!', 'success');
        }
        
        async function showAllTraffic() {
            log('[PULSE] Demonstrating all traffic patterns...', 'info');
            showLoading('Running comprehensive demo...');
            
            // Simulate all scenarios
            await simulateOptimalPerformance();
            await simulateDelay(2000);
            
            await checkBalance();
            await simulateDelay(1000);
            
            await makePayment();
            await simulateDelay(1000);
            
            await simulateHighTraffic();
            await simulateDelay(3000);
            
            await simulatePoorConnection();
            await simulateDelay(2000);
            
            await simulateNetworkFailure();
            await simulateDelay(3000);
            
            hideLoading();
            log('[PULSE] All traffic patterns demonstrated!', 'success');
        }
        
        async function simulateBackgroundPayment() {
            if (activePayments > 0) {
                activePayments--;
                const startTime = Date.now();
                
                try {
                    await simulateDelay(1500, 4000);
                    
                    const responseTime = Date.now() - startTime;
                    responseTimes.push(responseTime);
                    totalPayments++;
                    successfulPayments++;
                    
                    log(`[BACKGROUND] Payment completed in ${responseTime}ms`, 'success');
                    
                } catch (error) {
                    totalPayments++;
                    log(`[BACKGROUND] Payment failed: ${error.message}`, 'error');
                }
                
                updateMetrics();
            }
        }
        
        // Initialize real-time updates
        function initializeRealTimeUpdates() {
            // Update clock every second
            realTimeInterval = setInterval(updateClock, 1000);
            updateClock(); // Initial update
            
            // Background activity every 3 seconds
            backgroundActivityInterval = setInterval(simulateBackgroundActivity, 3000);
            
            // Initial metrics update
            updateMetrics();
            
            // Log initialization
            log('[PULSE] Real-time updates initialized', 'success');
            log('[PULSE] Clock updating every second', 'info');
            log('[PULSE] Background activity monitoring active', 'info');
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            log('[PULSE] Pulse app loaded successfully', 'success');
            initializeRealTimeUpdates();
            
            // Auto-start some background activity
            setInterval(() => {
                if (Math.random() < 0.1 && !isPaydayMode) {
                    concurrentUsers = Math.floor(generateRandomVariation(50, 50));
                    updateMetrics();
                }
            }, 5000);
        });
        
        // Cleanup on page unload
        window.addEventListener('beforeunload', () => {
            if (simulationInterval) clearInterval(simulationInterval);
            if (realTimeInterval) clearInterval(realTimeInterval);
            if (backgroundActivityInterval) clearInterval(backgroundActivityInterval);
        });
        
        // Handle page visibility change
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                log('[PULSE] App backgrounded - pausing intensive operations', 'warning');
            } else {
                log('[PULSE] App foregrounded - resuming operations', 'info');
                updateClock();
                updateMetrics();
            }
        });
    </script>
</body>
</html>
